//>>built
define("dgrid/selector","dojo/_base/kernel,dojo/_base/array,dojo/on,dojo/aspect,dojo/_base/sniff,put-selector/put".split(","),function(q,r,u,l,s,m){return function(b,e){function n(d){return function(c){var g=c.rows,f=g.length,c="false",e;for(e=0;e<f;e++){var h=a.cell(g[e],b.id).element;if(h&&(h=(h.contents||h).input,!h.disabled))h.checked=d,h.setAttribute("aria-checked",d)}if("checkbox"==i.type){g=a.selection;f=!1;for(e in g)if(g[e]!=a.allSelected){f=!0;break}i.indeterminate=f;i.checked=a.allSelected;
f?c="mixed":a.allSelected&&(c="true");i.setAttribute("aria-checked",c)}}}function t(d){if("click"==d.type||32==d.keyCode||!s("opera")&&13==d.keyCode||0===d.keyCode){var c=a.row(d),b=a._lastSelected&&a.row(a._lastSelected);a._selectionTriggerEvent=d;if("radio"==e){if(!b||b.id!=c.id)a.clearSelection(),a.select(c,null,!0),a._lastSelected=c.element}else c?(d.shiftKey?n(!0)({rows:[c]}):b=null,b=d.shiftKey?b:null,a.select(b||c,c,b?void 0:null),a._lastSelected=c.element):(m(this,(a.allSelected?"!":".")+
"dgrid-select-all"),a[a.allSelected?"clearSelection":"selectAll"]());a._selectionTriggerEvent=null}}function o(){a._hasSelectorInputListener=!0;j.push(l.before(a,"_initSelectionEvents",function(){this.on(".dgrid-selector:click,.dgrid-selector:keydown",t)}));var d=a._handleSelect;a._handleSelect=function(a){this.cell(a).column!=b&&d.apply(this,arguments)};if("function"==typeof b.disabled){var c=a.allowSelect;a.allowSelect=function(a){return c.call(this,a)&&!b.disabled(a.data)}}j.push(a.on("dgrid-select",
n(!0)));j.push(a.on("dgrid-deselect",n(!1)))}var j=[],a,i;b||(b={});if(b.type)b.selectorType=b.type,q.deprecated("columndef.type","use columndef.selectorType instead","dgrid 1.0");b.selectorType=e=e||b.selectorType||"checkbox";b.sortable=!1;var k=b.disabled,p="function"==typeof e?e:function(d,c,g){var f=c.parentNode;m(f&&f.contents?f:c,".dgrid-selector");c=c.input||(c.input=m(c,"input[type="+e+"]",{tabIndex:isNaN(b.tabIndex)?-1:b.tabIndex,disabled:k&&("function"==typeof k?k(g):k),checked:d}));c.setAttribute("aria-checked",
!!d);a._hasSelectorInputListener||o();return c};l.after(b,"init",function(){a=b.grid});l.after(b,"destroy",function(){r.forEach(j,function(a){a.remove()});a._hasSelectorInputListener=!1});b.renderCell=function(b,c,e){c=(c=b&&a.row(b))&&a.selection[c.id];p(c,e,b)};b.renderHeaderCell=function(d){var c=b.label||b.field||"";"radio"==e||!a.allowSelectAll?(d.appendChild(document.createTextNode(c)),a._hasSelectorInputListener||o()):p(!1,d,{});i=d.lastChild};return b}});