//>>built
define("dojomat/Application","routed/Request routed/Router dojo/has!dijit?dijit/registry:mijit/registry dojo/_base/declare dojo/_base/lang dojo/has dojo/on dojo/dom dojo/query dojo/topic dojo/dom-construct ./Notification ./Session dojo/domReady!".split(" "),function(k,l,f,m,c,g,n,p,q,d,h,r,s){var t=function(){g.add("native-history-state",function(a){return void 0!==a.history&&void 0!==a.history.pushState})},u=function(){g.add("native-localstorage",function(a){var b=!1;try{b=void 0!==a.localStorage&&
void 0!==a.localStorage.setItem}catch(c){}return b})};return m([],{lastRequest:null,router:new l,session:new s,notification:new r,cssNodes:{},domNode:null,constructor:function(a,b){c.mixin(this,a);this.domNode=p.byId(b)},run:function(){t();u();this.setSubscriptions();this.registerPopState();this.handleState()},clearCss:function(){for(var a in this.cssNodes)this.cssNodes.hasOwnProperty(a)&&h.destroy(this.cssNodes[a]);this.cssNodes={}},setCss:function(a,b){a=a||"";b=b||"all";this.cssNodes[b]||(this.cssNodes[b]=
h.create("style",{media:b},q("head")[0],"last"));this.cssNodes[b].styleSheet?this.cssNodes[b].styleSheet.cssText=a:this.cssNodes[b].innerHTML=a},prepareDomNode:function(){var a,b=this.domNode.id;f.byId(b)&&(a=h.create("div",{id:"new-dojomat-"+b+"-node"},f.byId(b).domNode,"after"),f.byId(b).destroyRecursive(),this.domNode=a,this.domNode.id=b)},handleState:function(a,b,c){var e;return function(){var d=this,f=arguments,g=c&&!e;clearTimeout(e);e=setTimeout(function(){e=null;c||a.apply(d,f)},b);g&&a.apply(d,
f)}}(function(){var a=null,b=new k(window.location.href);if(!this.lastRequest||!this.lastRequest.isSame(window.location.href))this.lastRequest=b,this.router.route(b),(a=this.router.getCurrentRoute())?a.run(b):this.makeNotFoundPage()},500,!0),registerPopState:function(){n(window,"popstate",c.hitch(this,function(a){this.handleState()}))},makePage:function(a,b,d){var e=function(b){this.clearCss();this.prepareDomNode();b=new b({request:a,router:this.router,session:this.session,notification:this.notification.get()},
this.domNode);this.notification.clear();b.startup()};d.length?require(d,c.hitch(this,function(){require([b],c.hitch(this,e))})):require([b],c.hitch(this,e))},makeNotFoundPage:function(){alert("Page not found")},makeErrorPage:function(a){alert("An error has occured")},setSubscriptions:function(){d.subscribe("dojomat/_AppAware/css",c.hitch(this,function(a){this.setCss(a.css,a.media)}));d.subscribe("dojomat/_AppAware/title",c.hitch(this,function(a){window.document.title=a.title}));d.subscribe("dojomat/_AppAware/notification",
c.hitch(this,function(a){this.notification.set(a)}));d.subscribe("dojomat/_AppAware/error",c.hitch(this,function(a){this.makeErrorPage(a)}));d.subscribe("dojomat/_AppAware/not-found",c.hitch(this,function(){this.makeNotFoundPage()}));d.subscribe("dojomat/_StateAware/push-state",c.hitch(this,function(a){this.pushState(a)}))},pushState:function(a){g("native-history-state")?(history.pushState({},"",a.url),this.handleState()):window.location=a.url}})});
//@ sourceMappingURL=Application.js.map