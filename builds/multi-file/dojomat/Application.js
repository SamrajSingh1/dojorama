//>>built
define("dojomat/Application","routed/Request routed/Router dojo/has!dijit?dijit/registry:mijit/registry dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has dojo/on dojo/query dojo/topic dojo/dom-construct ./Notification ./Session dojo/domReady!".split(" "),function(m,n,k,p,l,b,h,q,f,c,e,r,s){var t=function(){h.add("native-history-state",function(a){return void 0!==a.history&&void 0!==a.history.pushState})},u=function(){h.add("native-localstorage",function(a){var d=!1;try{d=void 0!==a.localStorage&&
void 0!==a.localStorage.setItem}catch(v){}return d})};return p([],{router:new n,session:new s,notification:new r,stylesheetNodes:[],cssNode:null,pageNodeId:"page",run:function(){t();u();this.setSubscriptions();this.registerPopState();this.handleState()},setStylesheets:function(a){var d=function(a,d){var b=null,g=null,c=null,b=f("head link[rel\x3dstylesheet]");d&&d.href&&(b.length?(g=b[b.length-1],c="after"):(g=f("head script")[0],c="before"),b={rel:"stylesheet",media:d.media||"all",href:d.href},a[a.length]=
e.create("link",b,g,c))};l.forEach(this.stylesheetNodes,function(a){e.destroy(a)});this.stylesheetNodes=[];a&&a.length?l.forEach(a,b.hitch(this,function(a){d(this.stylesheetNodes,a)})):d(this.stylesheetNodes,a)},setCss:function(a,d){a=a||"";var b={media:d||"all"},c=f("head script")[0];this.cssNode&&e.destroy(this.cssNode);this.cssNode=e.create("style",b,c,"before");this.cssNode.styleSheet?this.cssNode.styleSheet.cssText=a:this.cssNode.innerHTML=a},setPageNode:function(){var a={id:this.pageNodeId},
d=f("body")[0];k.byId(this.pageNodeId)&&k.byId(this.pageNodeId).destroyRecursive();e.create("div",a,d,"last")},handleState:function(a,d,b){var c;return function(){var e=this,g=arguments,f=b&&!c;clearTimeout(c);c=setTimeout(function(){c=null;b||a.apply(e,g)},d);f&&a.apply(e,g)}}(function(){var a=null,b=new m(window.location.href);this.router.route(b);(a=this.router.getCurrentRoute())?a.run(b):this.makeNotFoundPage()},500,!0),registerPopState:function(){q(window,"popstate",b.hitch(this,function(a){this.handleState()}))},
makePage:function(a,d,c,e){var f=function(b){this.setStylesheets(e);this.setCss();this.setPageNode();b=new b({request:a,router:this.router,session:this.session,notification:this.notification.get()},this.pageNodeId);this.notification.clear();b.startup()};c.length?require(c,b.hitch(this,function(){require([d],b.hitch(this,f))})):require([d],b.hitch(this,f))},makeNotFoundPage:function(){alert("Page not found")},makeErrorPage:function(a){alert("An error has occured")},setSubscriptions:function(){c.subscribe("dojomat/_AppAware/css",
b.hitch(this,function(a){this.setCss(a.css,a.media)}));c.subscribe("dojomat/_AppAware/stylesheets",b.hitch(this,function(a){this.setStylesheets(a)}));c.subscribe("dojomat/_AppAware/title",b.hitch(this,function(a){window.document.title=a.title}));c.subscribe("dojomat/_AppAware/notification",b.hitch(this,function(a){this.notification.set(a)}));c.subscribe("dojomat/_AppAware/error",b.hitch(this,function(a){this.makeErrorPage(a)}));c.subscribe("dojomat/_AppAware/not-found",b.hitch(this,function(){this.makeNotFoundPage()}));
c.subscribe("dojomat/_StateAware/push-state",b.hitch(this,function(a){this.pushState(a)}))},pushState:function(a){h("native-history-state")?(history.pushState({},"",a.url),this.handleState()):window.location=a.url}})});
//@ sourceMappingURL=Application.js.map